{% extends 'base.html' %}
{% load static %}

{% block content %}

<section class="section-content padding-y bg">
	<div class="container">

		<!-- ============================ COMPONENT 1 ================================= -->
		<div class="card">
			<div class="row no-gutters">
				<aside class="col-md-4">
					<article class="gallery-wrap">
						<div class="img-wrap mainImage">
							<center>
								{% if single_product.images %}
									<img src="https://yourfiles.cloud/uploads/{{single_product.imgfile}}">
								{% else %}
									<img src="https://yourfiles.cloud/uploads/none.jpg">
								{% endif %}
							</center>
						</div> <!-- img-big-wrap.// -->

					</article> <!-- gallery-wrap .end// -->
					
				</aside>
				<main class="col-md-6 border-left">

						<!-- <form action="{% url 'add_cart' single_product.id %}" method="POST"> 
						-->
						{% csrf_token %}
				
						<article class="content-body">
							<input type="text" class="form-control form-control-sm"  id="ruta" name="ruta" value="../../../store/" hidden>

							<h2 class="title">{{ single_product.product_name }}</h2>
	<!--						<div class="rating-star">
								<span>
									<i class="fa fa-star{% if single_product.averageReview < 0.5 %}-o{% elif single_product.averageReview >= 0.5 and single_product.averageReview < 1 %}-half-o {% endif %}" aria-hidden="true"></i>
									<i class="fa fa-star{% if single_product.averageReview < 1.5 %}-o{% elif single_product.averageReview >= 1.5 and single_product.averageReview < 2 %}-half-o {% endif %}" aria-hidden="true"></i>
									<i class="fa fa-star{% if single_product.averageReview < 2.5 %}-o{% elif single_product.averageReview >= 2.5 and single_product.averageReview < 3 %}-half-o {% endif %}" aria-hidden="true"></i>
									<i class="fa fa-star{% if single_product.averageReview < 3.5 %}-o{% elif single_product.averageReview >= 3.5 and single_product.averageReview < 4 %}-half-o {% endif %}" aria-hidden="true"></i>
									<i class="fa fa-star{% if single_product.averageReview < 4.5 %}-o{% elif single_product.averageReview >= 4.5 and single_product.averageReview < 5 %}-half-o {% endif %}" aria-hidden="true"></i>
									<span>{{single_product.countReview}} reviews</span>
									</span>
							</div>
-->

							<div class="mb-3">
								<var class="price h4">$ {{single_product.price}}</var>
							</div>

							<p>{{ single_product.description }}</p>
							<hr>
							{% if single_product.variation_set.colors.count > 0 %}
							<div class="row">
								<div class="item-option-select">
									<h6>Choose Color</h6>
									<select name="color" class="form-control" required>
										<option value="" disabled selected>Select</option>
										{% for i in single_product.variation_set.colors %}
										<option value="{{ i.variation_value | lower }}">{{ i.variation_value | capfirst }}</option>
										{% endfor %}
									</select>
								</div>
							</div>
							{% endif%}
							{% if single_product.variation_set.sizes.count > 0 %}
							<div class="row">
								<div class="item-option-select">
									<h6>Select Size</h6>
									<select name="size" class="form-control" required>
										<option value="" disabled selected>Select</option>
										{% for i in single_product.variation_set.sizes %}
										<option value="{{ i.variation_value | lower }}">{{ i.variation_value | capfirst }}</option>
										{% endfor %}
									</select>
								</div>
							</div>
							{% endif %}
							{% if single_product.variation_set.letras.count > 0 %}
							<div class="row">
								<div class="item-option-select">
									<h6>Select Letra</h6>
									<select name="letra" class="form-control" required>
										<option value="" disabled selected>Select</option>
										{% for i in single_product.variation_set.letras %}
										<option value="{{ i.variation_value | lower }}">{{ i.variation_value | capfirst }}</option>
										{% endfor %}
									</select>
								</div>
							</div>
							{% endif %}
						
							{% if single_product.stock <= 0 %}
							<h5 class="text-danger">Sin Stock</h5>
							{% endif %}
<!--							<button type="submit" class="btn  btn-primary"> <span class="text">Add to Cart</span> <i class="fa fa-shopping-cart"></i> </button>
								<a href="{% url 'store' %}" class="btn btn-secondary">Continuar Pedido</a>
-->							<button class="btn btn-secondary" onclick="volverAlListado()">Continuar Pedido</button>
 												
						</article> <!-- product-info-aside .// -->
					
				</main> <!-- col.// -->
			</div> <!-- row.// -->
		</div> <!-- card.// -->
		<!-- ============================ COMPONENT 1 END .// ================================= -->

		<br>

	</div> <!-- container .//  -->
</section>
<!-- ========================= SECTION CONTENT END// ========================= -->
<script>
	function volverAlListado() {
	  // Obtiene la URL guardada en sessionStorage
	  const rutaAnterior = sessionStorage.getItem('rutaAnterior');
	  
	  // Verifica si hay una ruta guardada y muestra una alerta
	  if (rutaAnterior) {
		//alert(`Redirigiendo a la ruta guardada: ${rutaAnterior}`);
		window.location.href = rutaAnterior;
	  } else {
		//alert("No hay ruta guardada. Volviendo al listado sin posición específica.");
		// Si no hay ruta guardada, redirige al listado de productos sin posición específica
		window.location.href = 'store/';
	  }
	}
  </script>


 

{% endblock %}